<!DOCTYPE html>
<html>

<head>
	<meta charset='utf-8'>
	<meta name='viewport' content='width=device-width, initial-scale=1, user-scalable=no'>
	<meta name='mobile-web-app-capable' content='yes'>
	<meta name='apple-mobile-web-app-capable' content='yes'>
	<link rel='icon' type='image/png' sizes='32x32' href='favicon-32x32.png'>
	<link rel='icon' type='image/png' sizes='96x96' href='favicon-96x96.png'>
	<link rel='stylesheet' href='style.css'>

	<title>Prototype ICU</title>
	<!-- include A-Frame -->
	<script src="https://aframe.io/releases/1.2.0/aframe.min.js">

	</script>
	<!-- include Resonance Audio -->
	<script src="https://cdn.jsdelivr.net/npm/resonance-audio/build/resonance-audio.min.js">
	</script>
	<script src="components/timeline.js">
	</script>
	<script src="components/resonanceScene.js">
	</script>
	<script src="components/startExperience.js">
	</script>
	<script src="components/heartrate.js">
	</script>
</head>

<body style='margin : 0px; overflow: hidden;'>

	<div id="startX">
		<button id="startwithoutHR">
      Start Experience without Heart Rate Monitoring
    </button>
		<button id="startwithHR">
      Start Experience
    </button>
    <button id = "pairing">
      Pair Device
    </button>
  </div>



  
	<a-scene heartratemonitor pairDevice resonancesystem timeline startexperience stats inspector>
		<a-assets timeout="3000">
			<!-- preload sounds and assets here -->
      <audio id="tutorial" src='resources/tutorialPLACEHOLDER.mp3' preload="auto" onended=""></audio>

      <audio id="pinknoise" src='resources/pinknoise.wav' preload="auto"></audio>

      <audio id="ekgBeep1" src='resources/singleEKGbeepPREsilence2s.wav' preload="auto"></audio> <!-- duration 750ms for 80bpm -->
      <audio id="ekgBeep2" src='resources/singleEKGbeepPREsilence2s.wav' preload="auto"></audio> <!-- duration 1200ms for 50bpm -->
      <audio id="ekgBeep3" src='resources/singleEKGbeep.wav' preload="auto"></audio>
      <audio id="ekgBeep4" src='resources/singleEKGbeep.wav' preload="auto"></audio>
      <audio id="IVpump1" src='resources/IVpump.wav' preload="auto"></audio>
      <audio id="IVpump2" src='resources/IVpump.wav' preload="auto"></audio>
      <audio id="coughing1" src='resources/coughing1.wav' preload="auto"></audio>
      <audio id="telephone" src='resources/telephone.wav' preload="auto"></audio>
      <audio id="hello_lowQ" src='resources/hello_lowQ.wav' preload="auto"></audio>
      <audio id="roomfan" src='resources/A1-0023_Room Tone Ceiling Fan Runs.wav' preload="auto"></audio>
      <img id="hospital360" src='resources/hospital.jpeg' preload='auto'></img>
		</a-assets>

    <a-entity server-logger></a-entity>

    	<!-- define a simple camera -->
		<a-entity camera="active: true" look-controls wasd-controls position="0 1.6 0">
			<a-entity cursor="fuse: true; fuseTimeout: 1000" position="0 0 -0.1" geometry="primitive: circle; radius: 0.003"
			 material="color: black; shader: flat" raycaster="interval: 500; objects: [data-raycastable]">
			</a-entity>
		</a-entity>

    <!-- ----TUTORIAL CONTENT---- -->
    <a-entity id="tutorialcontainer" visible="false">
      <a-entity id="s_tutorial" position='0 0 -0.5' material='opacity: 0.5' resonancesource="src: #tutorial;"></a-entity>
    </a-entity>
    


    <!-- ----ANCHORING CONTENT---- -->
    <a-entity id="anchoringcontainer" visible="false">
      <a-entity id="s_anchor" position='0 0 0' material='opacity: 0.5' resonancesource="src: #pinknoise"></a-entity>
    </a-entity>


    <!-- ----MAIN SCENE CONTENT---- -->
    <a-entity id="mainscenecontainer" visible="false">
      <!-- TODO picture on sphere for demo purposes -->
      <a-sphere radius=9 src='#hospital360' rotation="0 -90 0" position='0 1.6 0' material='side: back'></a-sphere>
      
      <!-- here define patients, need to be data-raycastable for cursor interaction and raycaster-listen for interaction-->
      <!-- animation box test <a-box position='-0.5 1.5 -1' animation="property: object3D.position.x; to: -1.0; dur: 1000; dir: alternate; easing: easeInOutElastic; loop: true" material='color: blue;' depth='0.2' height='0.2' width='0.2' data-raycastable raycaster-listen patient='id:1'></a-box>
      -->
      
      <a-entity position='-2 1 -2' patient='id:1; ekg:false; hr: 50; ivpump: false; sounds: #coughing1, #ekgBeep3, #ekgBeep4' data-raycastable raycaster-listen></a-entity>
      <!-- <a-entity position='2 1 -2' patient='id:2; ekg:true; hr: 80; cough: true' data-raycastable raycaster-listen></a-entity> -->
    

      <!-- ENVIRONMENTAL SOUNDS -->
      <a-box position='-4.9 1.6 2' material='color: green; opacity: 0.6' depth='0.1' height='0.2' width='0.1' resonancesource="src: #telephone;" telephone data-raycastable raycaster-listen></a-box>
      <a-box position='1 2.8 0' material='color: green; opacity: 0.6' depth='0.1' height='0.2' width='0.1' resonancesource="src: #roomfan; gain: 2; width: 180"></a-box>

      <!-- here define room with wireframe outlines for reference CHANGES NEED TO BE MIRRORED IN resonanceScene.js
      "20 m² per bed for common rooms" according to Valentin, Andreas & Ferdinande, Patrick. (2011). Recommendations on basic requirements for intensive care units: Structural and organizational aspects. Intensive Care Medicine. 37. 1575-1587. 10.1007/s00134-011-2300-7.
      using 80 m² for now -->
      <a-box position='0 1.5 0' depth='8' height='3' width='10' material='color: green; side: back; wireframe: true'></a-box>
    </a-entity>
	</a-scene>


</body>

</html>